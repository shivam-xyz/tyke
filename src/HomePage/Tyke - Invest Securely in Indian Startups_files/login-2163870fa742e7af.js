(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3459],{97106:function(e,n,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/login",function(){return r(3388)}])},3388:function(e,n,r){"use strict";r.r(n),r.d(n,{__N_SSP:function(){return X},default:function(){return Y}});var t=r(85893),i=r(49381),a=r(62492),s=r(17475),o=r(67720),u=r(50122),l=r(14332),c=r(67294),d=r(25932),m=r(96152),f=r(28520),h=r.n(f),v=r(36158);function p(e,n,r,t,i,a,s){try{var o=e[a](s),u=o.value}catch(l){return void r(l)}o.done?n(u):Promise.resolve(u).then(t,i)}var x,g=(x=h().mark((function e(n){var r,t;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=1,e.next=4,v.Y.post("/auth/sign-in/verify-username",{username:n});case 4:r=e.sent,e.next=11;break;case 7:throw e.prev=7,e.t0=e.catch(1),t=e.t0,new Error(t.response?t.response.data.message||t.response.data:t.message);case 11:return e.abrupt("return",r.data);case 12:case"end":return e.stop()}}),e,null,[[1,7]])})),function(){var e=this,n=arguments;return new Promise((function(r,t){var i=x.apply(e,n);function a(e){p(i,r,t,a,s,"next",e)}function s(e){p(i,r,t,a,s,"throw",e)}a(void 0)}))}),j=r(89551),b=r(1853),y=r(13815),S=r(2734),w=r(98456),Z=r(82175),_=r(62286),E=r(88767),k=r(74231);function P(e,n,r){return n in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}function O(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{},t=Object.keys(r);"function"===typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),t.forEach((function(n){P(e,n,r[n])}))}return e}k.i_({mixed:{required:"Please fill this field"}});var N=k.Ry({email:k.Z_().email("Please enter a valid email").required()});function L(){var e=(0,_.parseCookies)(),n=(null===e||void 0===e?void 0:e.magicData)?JSON.parse(e.magicData):void 0;try{var r;return{email:(null===(r=null===n||void 0===n?void 0:n.user[0])||void 0===r?void 0:r.email)||""}}catch(t){return{email:""}}}var I=function(e){var n=e.goToNextStep,r=e.setEmail,i=(0,S.Z)(),a=(0,E.useMutation)(g,{onSuccess:function(){return n()}}),s=a.isLoading,o=a.isSuccess,u=a.error,l=a.mutate;return(0,t.jsx)(Z.J9,{initialValues:L(),enableReinitialize:!0,validationSchema:N,onSubmit:function(e){l(e.email),r(e.email)},children:(0,t.jsxs)(Z.l0,{children:[(0,t.jsx)(y.Z,{type:"text",label:"",name:"email",placeholder:"Email"})," ",!s&&u&&(0,t.jsx)(b.Z,{children:u.message}),(0,t.jsx)(j.Z,O({disabled:s||o},s?{text:(0,t.jsx)(w.Z,{size:"1rem",color:"inherit"})}:{text:"Log In"},{fullWidth:!0,sx:P({mt:"-1rem !important"},i.breakpoints.down("sm"),{mt:"0.5rem !important"}),size:"medium"}))]})})};function T(e,n,r,t,i,a,s){try{var o=e[a](s),u=o.value}catch(l){return void r(l)}o.done?n(u):Promise.resolve(u).then(t,i)}var W=function(e){return function(){var n=this,r=arguments;return new Promise((function(t,i){var a=e.apply(n,r);function s(e){T(a,t,i,s,o,"next",e)}function o(e){T(a,t,i,s,o,"throw",e)}s(void 0)}))}}(h().mark((function e(n){var r,t,i,a;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.username,t=n.otp,e.prev=2,e.next=5,v.Y.post("/auth/sign-in/verify-username-otp",{username:r,otp:t});case 5:i=e.sent,e.next=12;break;case 8:throw e.prev=8,e.t0=e.catch(2),a=e.t0,new Error(a.response?a.response.data.message||a.response.data:a.message);case 12:return e.abrupt("return",i.data.access_token);case 13:case"end":return e.stop()}}),e,null,[[2,8]])}))),D=r(62023),R=r(58119),q=r(23842),z=r(11163),H=r(83913);k.i_({mixed:{required:"Please fill this field"}});var M=k.Ry({otp:k.Z_().matches(/^\d{6}$/,"Please enter all 6 digits").required()}),C={otp:""},J=function(e){var n=e.email,r=(0,z.useRouter)().push,a=(0,q.n)(),o=a.isLoading,u=a.login,l=(0,E.useMutation)(W,{onSuccess:function(e){(0,R.wl)("Signin Successful",{tykeEventValue:n,channel:"email"}),u(e)}}),d=l.isLoading,m=l.isSuccess,f=l.error,h=l.mutate;return(0,c.useEffect)((function(){m&&!o&&r(sessionStorage.getItem("signup_origin")||"/profile")}),[m,o]),(0,t.jsx)(i.Z,{children:(0,t.jsxs)(H.Z,{children:[(0,t.jsx)(s.Z,{variant:"body1",color:"grey.500",children:"We\u2019ve sent an OTP to your registered email ID. Enter it here to verify your email and continue!"}),(0,t.jsx)(Z.J9,{initialValues:C,validationSchema:M,onSubmit:function(e){h({username:n,otp:e.otp})},children:(0,t.jsxs)(Z.l0,{children:[(0,t.jsx)(D.Z,{label:"",name:"otp",resend_value:n,resend:g}),!(d||o)&&f&&(0,t.jsx)(b.Z,{children:f.message}),(0,t.jsx)(j.Z,{disabled:d||o||m,text:d||o?(0,t.jsx)(w.Z,{size:"1rem",color:"inherit"}):"Submit",fullWidth:!0})]})})]})})},V=r(41664),A=function(e){var n=e.defaultEmail,r=(0,c.useState)(n?2:1),i=r[0],a=r[1],f=(0,c.useState)(null!==n&&void 0!==n?n:""),h=f[0],v=f[1];return(0,t.jsx)(l.M,{exitBeforeEnter:!0,children:(0,t.jsxs)(H.Z,{children:[(0,t.jsx)(m.Z,{title:"Log in",headerSx:{textAlign:"center",mb:"2rem"}}),1===i?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(d.Z,{isSignUp:!1}),(0,t.jsx)(o.Z,{sx:{mt:"2rem",mb:"1rem"},children:(0,t.jsx)(s.Z,{variant:"overline",display:"block",color:"grey.300",sx:{lineHeight:"1em"},children:"OR LOG IN WITH EMAIL"})}),(0,t.jsx)(I,{goToNextStep:function(){return a(2)},setEmail:function(e){return v(e)}}),(0,t.jsx)(o.Z,{sx:{mt:"2.5rem",mb:"1.5rem"}}),(0,t.jsx)(V.default,{href:"/startup/sign-in",passHref:!0,children:(0,t.jsx)(u.Z,{variant:"uiSmall2",color:"secondary.main",sx:{display:"block",fontWeight:600},underline:"hover",gutterBottom:!0,children:"Log in as founder"})}),(0,t.jsxs)(s.Z,{variant:"uiSmall2",display:"block",weight:300,children:["Don\u2019t have an account?"," ",(0,t.jsx)(V.default,{href:"/sign-up",passHref:!0,children:(0,t.jsx)(u.Z,{variant:"inherit",color:"secondary.main",sx:{fontWeight:600},underline:"hover",children:"Sign up instead"})})]})]}):(0,t.jsx)(J,{email:h})]})})},B=function(e){var n=e.email;return(0,t.jsx)(i.Z,{children:(0,t.jsx)(A,{defaultEmail:n||""})})};B.Layout=a.Z;var X=!0,Y=B}},function(e){e.O(0,[1653,4838,6629,9774,2888,179],(function(){return n=97106,e(e.s=n);var n}));var n=e.O();_N_E=n}]);